<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask AssemblyFile="bin\debug\BizTalkDeploymentFramework.Tasks.BizTalk.dll" TaskName="UpdateBizTalkDebuggingConfig" />
  <UsingTask AssemblyFile="bin\debug\BizTalkDeploymentFramework.Tasks.BizTalk.dll" TaskName="UpdateBizTalkAppDomainConfig" />
  <UsingTask AssemblyFile="bin\debug\BizTalkDeploymentFramework.Tasks.BizTalk.dll" TaskName="CheckForServiceInstances" />
  <UsingTask AssemblyFile="bin\debug\BizTalkDeploymentFramework.Tasks.BizTalk.dll" TaskName="TerminateServiceInstances" />
  <UsingTask AssemblyFile="bin\debug\BizTalkDeploymentFramework.Tasks.BizTalk.dll" TaskName="UpdateSSOConfigItem" />

  <ItemGroup>
    <ABCPatternAssignmentRule Include="*">
      <AssemblyNamePattern>ABC.*, Version=1.0.0.0, Culture=neutral, PublicKeyToken=51a4d4439455a1a7</AssemblyNamePattern>
    </ABCPatternAssignmentRule>
  </ItemGroup>

  <ItemGroup>
    <BizTalkAppDomain Include="JKL_1.0">
      <SecondsIdleBeforeShutdown>30</SecondsIdleBeforeShutdown>
      <SecondsEmptyBeforeShutdown>30</SecondsEmptyBeforeShutdown>
      <ConfigurationFilePath>$(MSBuildProjectDirectory)\JKL.config</ConfigurationFilePath>
      <AssemblyNameRegexes>(JKL.Schemas,.*)|(JKL.Schemas\..*);JKLComponent.*</AssemblyNameRegexes>
      <AssemblyNames>JKL.Maps, Version=1.0.0.0, Culture=neutral, PublicKeyToken=51a4d4439455a1a7</AssemblyNames>
    </BizTalkAppDomain>
    <BizTalkAppDomain Include="STU_1.0">
      <SecondsIdleBeforeShutdown>60</SecondsIdleBeforeShutdown>
      <SecondsEmptyBeforeShutdown>90</SecondsEmptyBeforeShutdown>
      <ApplicationBase>$(MSBuildProjectDirectory)</ApplicationBase>
      <PrivateBinPath>bin</PrivateBinPath>
      <ConfigurationFilePath>$(MSBuildProjectDirectory)\STU.config</ConfigurationFilePath>
      <AssemblyNameRegexes>(STU.Schemas,.*)|(STU.Schemas\..*);STUComponent.*</AssemblyNameRegexes>
      <AssemblyNames>STU.Maps, Version=5.0.0.0, Culture=neutral, PublicKeyToken=51a4d4439455a1a7</AssemblyNames>
    </BizTalkAppDomain>
  </ItemGroup>

  <Target Name="TestAppDomainConfig">
    <UpdateBizTalkAppDomainConfig AppDomainName="ABC_1.0" Remove="true" PatternAssignmentRules="@(ABCPatternAssignmentRule)" />

    <UpdateBizTalkAppDomainConfig AppDomainName="XYZ_1.0" Remove="true" />

    <UpdateBizTalkAppDomainConfig AppDomains="@(BizTalkAppDomain)" Remove="false" />
  </Target>

  <Target Name="TestDebuggingConfig">
    <UpdateBizTalkDebuggingConfig ExtendedLogging="true" ValidateCorrelations="true" />
  </Target>

  <Target Name="TestCheckForServiceInstances">
    <CheckForServiceInstances Application="BizTalkSample_1.0" />
  </Target>

  <Target Name="TestTerminateServiceInstances">
    <TerminateServiceInstances Application="BizTalkSample_1.0" />
  </Target>
  
  <Target Name="UpdateSSOConfigItem">
    <UpdateSSOConfigItem BizTalkAppName="DeploymentFramework.Samples.BasicMasterBindings" SSOItemName="TestSetting" SSOItemValue="$(MSBuildProjectDirectory)" />
  </Target>
</Project>
